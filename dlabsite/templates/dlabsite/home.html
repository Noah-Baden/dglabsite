{% load staticfiles %}
<html>
    <head>
    	<!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    	<meta name="description" content="Lab webpage for the Greene Lab at Washington University in St. Louis School of Medicine">
    	<meta name="author" content="Andrew Van">
        <link rel="icon" href="{% static 'dlabsite/img/favicon.ico' %}">
    	<meta charset="utf-8">
    	<meta name="viewport" content="width=device-width, initial-scale=1">
    	<title>Greene Lab</title>
        <link href="https://fonts.googleapis.com/css?family=Comfortaa:300" rel="stylesheet">
        <script data-pace-options='{"ajax": false, "elements": false}' src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js"></script>
        <link href="{% static 'dlabsite/css/pace-theme-center-circle.min.css' %}" rel="stylesheet">
        <link href="{% static 'dlabsite/css/foundation.css' %}" rel="stylesheet">
    </head>
    <body style="margin:0px 0px;height:100%;background:#BFD8D2;overflow:hidden;">
        <div class="grid-container fluid canvas-container grid-frame">
        </div>
        <div id="rotator" style="height:100px;width:100px"></div>
        <div style="position:absolute; z-index:100; bottom:5%; left:5%;">
            <p style="font-size:8vmin;">greene lab</p>
            <a href="{% url 'dlabsite:index' %}" class="button custom" style="font-size:3vmin;">enter site</a>
        </div>

        <!-- Javascript -->
        <script
          src="https://code.jquery.com/jquery-3.2.1.min.js"
          integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
          crossorigin="anonymous"></script>
        <script src="{% static 'dlabsite/js/foundation.js' %}"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/92/three.min.js"></script>
	    <script src="{% static 'dlabsite/js/OrbitControls.js' %}"></script>s
        <script>

        // Setup renderer
        var renderer = new THREE.WebGLRenderer();
        renderer.setSize($('body').width(),$('body').height());
        $('.canvas-container').append(renderer.domElement);

        // Setup scene
        var scene = new THREE.Scene();
        scene.background = new THREE.Color(0xBFD8D2);

    	// Setup lighting
    	var light = new THREE.PointLight(0xffffff,1,800);
    	light.position.set(0,300,0);
    	scene.add(light);
    	var light = new THREE.PointLight(0xffffff,1,800);
    	light.position.set(300,0,0);
    	scene.add(light);
    	var light = new THREE.PointLight(0xffffff,1,800);
    	light.position.set(0,0,300);
    	scene.add(light);
    	var light = new THREE.PointLight(0xffffff,1,800);
    	light.position.set(0,-300,0);
    	scene.add(light);
    	var light = new THREE.PointLight(0xffffff,1,800);
    	light.position.set(-300,0,0);
    	scene.add(light);
    	var light = new THREE.PointLight(0xffffff,1,800);
    	light.position.set(0,0,-300);
    	scene.add(light);

        // Setup camera
        var camera = new THREE.PerspectiveCamera(75,$('body').width()/$('body').height(),0.1,1000);
        camera.position.z = 200;
        var controls = new THREE.OrbitControls(camera);
        controls.autoRotate = false;

        // load geometries
        var loader = new THREE.JSONLoader();
        var left_pial; var right_pial;    
        loader.load(
            "{% static 'dlabsite/js/left_pial.json' %}",
            function(geometry) {
                left_pial = geometry;
                scene.add(new THREE.Mesh(left_pial,new THREE.MeshLambertMaterial({vertexColors:THREE.VertexColors})));
            },
            function(xhr) {},
            function(err) { console.log(err); }
        );    
        loader.load(
            "{% static 'dlabsite/js/right_pial.json' %}",
            function(geometry) {
                right_pial = geometry;
                scene.add(new THREE.Mesh(right_pial,new THREE.MeshLambertMaterial({vertexColors:THREE.VertexColors})));
            },
            function(xhr) {},
            function(err) { console.log(err); }
        );

        // Render loop
        function animate() {
        	requestAnimationFrame(animate);
            controls.update();
            render();
        }
        animate();

        // Render function
        function render() {
            renderer.render(scene,camera);
        }

        // resize renderer and camera on window resize
        $(window).resize(function() {
            camera.aspect = $('body').width()/$('body').height();
            camera.updateProjectionMatrix();
            renderer.setSize($('body').width(),$('body').height());
        });

        </script>
    </body>
</html>
